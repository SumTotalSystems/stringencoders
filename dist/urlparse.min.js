/*
 * Copyright (c) 2010 Nick Galbreath
 * http://code.google.com/p/stringencoders/source/browse/#svn/trunk/javascript
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
/*
 * Additional edits made by Michael Gardner.
 *
 * Copyright (c) 2016 SumTotal Systems, LLC
 * http://code.google.com/p/stringencoders/source/browse/#svn/trunk/javascript
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
!function(e,t){"use strict";"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.urlparse=t()}(this,function(){"use strict";var e={};return e.normalizepath=function(e){if(!e||"/"===e)return"/";var t=e.split("/"),r=[];t[0]&&r.push("");for(var n=0;n<t.length;++n)".."===t[n]?r.length>1?r.pop():r.push(t[n]):"."!=t[n]&&r.push(t[n]);return e=r.join("/"),e||(e="/"),e},e.urlnormalize=function(t){var r=e.urlsplit(t);switch(r.scheme){case"file":r.query="",r.fragment="";break;case"http":case"https":("http"===r.scheme&&80==r.port||"https"===r.scheme&&443==r.port)&&(delete r.port,r.netloc=r.hostname);break;default:return t}return r.path=e.normalizepath(r.path),e.urlunsplit(r)},e.urldefrag=function(e){var t=e.indexOf("#");return-1==t?[e,""]:[e.substr(0,t),e.substr(t+1)]},e.urlsplit=function(e,t,r){var n;"undefined"==typeof r&&(r=!0);var a=/^([A-Za-z]+)?(:?\/\/)([0-9.\-A-Za-z]*)(?::(\d+))?(.*)$/,s=/([^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/,h={},o=e.match(a);return o?(h.scheme=o[1]||t||"",h.hostname=o[3].toLowerCase()||"",h.port=parseInt(o[4],10)||"",h.netloc=o[3],o[4]&&(h.netloc+=":"+o[4]),n=o[5]):(h.scheme=t||"",h.netloc="",h.hostname="",n=e),h.scheme=h.scheme.toLowerCase(),o=n.match(s),h.path=o[1]||"",h.query=o[2]||"",r?h.fragment=o[3]||"":h.fragment="",h},e.urlunsplit=function(e){var t="";return e.scheme&&(t+=e.scheme+"://"),e.netloc?(""===t&&(t+="//"),t+=e.netloc):e.hostname&&(""===t&&(t+="//"),t+=e.hostname,e.port&&(t+=":"+e.port)),e.path&&(t+=e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},e.urljoin=function(t,r,n){"undefined"==typeof n&&(n=!0);var a=e.urlsplit(r);if(a.scheme)return n?e.urldefrag(r)[0]:r;var s=e.urlsplit(t);if(s.scheme||(s.scheme=a.scheme),s.netloc&&s.hostname||(s.netloc=a.netloc,s.hostname=a.hostname,s.port=a.port),a.path.length>0)if("/"==a.path.charAt(0))s.path=a.path;else{var h=s.path.lastIndexOf("/");-1==h?s.path=a.path:s.path=s.path.substr(0,h)+"/"+a.path}return s.path=e.normalizepath(s.path),s.query=a.query,n?s.fragment=a.fragment:s.fragment="",e.urlunsplit(s)},e});