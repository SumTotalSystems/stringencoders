!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.urlparse=t()}(this,function(){/*
 * Copyright (c) 2010 Nick Galbreath
 * http://code.google.com/p/stringencoders/source/browse/#svn/trunk/javascript
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
/*
 * Additional edits made by Michael Gardner.
 *
 * Copyright (c) 2016 SumTotal Systems, LLC
 * http://code.google.com/p/stringencoders/source/browse/#svn/trunk/javascript
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
"use strict";var e={};return e.normalizepath=function(e){if(!e||"/"===e)return"/";var t=e.split("/"),r=[];t[0]&&r.push("");for(var n=0;n<t.length;++n)".."===t[n]?r.length>1?r.pop():r.push(t[n]):"."!=t[n]&&r.push(t[n]);return e=r.join("/"),e||(e="/"),e},e.urlnormalize=function(t){var r=e.urlsplit(t);switch(r.scheme){case"file":r.query="",r.fragment="";break;case"http":case"https":("http"===r.scheme&&80==r.port||"https"===r.scheme&&443==r.port)&&(delete r.port,r.netloc=r.hostname);break;default:return t}return r.path=e.normalizepath(r.path),e.urlunsplit(r)},e.urldefrag=function(e){var t=e.indexOf("#");return-1==t?[e,""]:[e.substr(0,t),e.substr(t+1)]},e.urlsplit=function(e,t,r){var n;"undefined"==typeof r&&(r=!0);var a=/^([A-Za-z]+)?(:?\/\/)([0-9.\-A-Za-z]*)(?::(\d+))?(.*)$/,h=/([^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/,s={},o=e.match(a);return o?(s.scheme=o[1]||t||"",s.hostname=o[3].toLowerCase()||"",s.port=parseInt(o[4],10)||"",s.netloc=o[3],o[4]&&(s.netloc+=":"+o[4]),n=o[5]):(s.scheme=t||"",s.netloc="",s.hostname="",n=e),s.scheme=s.scheme.toLowerCase(),o=n.match(h),s.path=o[1]||"",s.query=o[2]||"",r?s.fragment=o[3]||"":s.fragment="",s},e.urlunsplit=function(e){var t="";return e.scheme&&(t+=e.scheme+"://"),e.netloc?(""===t&&(t+="//"),t+=e.netloc):e.hostname&&(""===t&&(t+="//"),t+=e.hostname,e.port&&(t+=":"+e.port)),e.path&&(t+=e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},e.urljoin=function(t,r,n){"undefined"==typeof n&&(n=!0);var a=e.urlsplit(r);if(a.scheme)return n?e.urldefrag(r)[0]:r;var h=e.urlsplit(t);if(h.scheme||(h.scheme=a.scheme),h.netloc&&h.hostname||(h.netloc=a.netloc,h.hostname=a.hostname,h.port=a.port),a.path.length>0)if("/"==a.path.charAt(0))h.path=a.path;else{var s=h.path.lastIndexOf("/");-1==s?h.path=a.path:h.path=h.path.substr(0,s)+"/"+a.path}return h.path=e.normalizepath(h.path),h.query=a.query,n?h.fragment=a.fragment:h.fragment="",e.urlunsplit(h)},e});